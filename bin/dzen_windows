#!/bin/bash
# Dzen Popup displaying all window on current desktop


# Font and colors:
font="-*-inconsolata-*-*-*-*-12-*-*-*-*-*-iso8850-*"

bgn='#303030'
bgs='#ac4142'
fgn='#eeeeee'
fgs='#ac4142'


# Line number and width:
num=$(wmctrl -l | wc -l)
len=$(wmctrl -l | wc -L)
stringlen=$(( $len - 28))
width=$((30 + $(($stringlen * 6 ))  ))


desknum=$(wmctrl -d | grep \* | awk '{print $1}')

# Bash version
(echo "Open windows:" ; wmctrl -l | while read line; do \
[[ ${line:12:1} == $desknum ]] && \
echo "^ca(1, wmctrl -i -a "${line:0:10} ") ^fg($fgs)^c(7)^fg()" ${line:28} "^ca()" || \
echo "^ca(1, wmctrl -i -a "${line:0:10} ") ^fg()^c(7)" ${line:28} "^ca()"; done) | dzen2 -p 5 -m -l $num -e 'onstart=uncollapse;button3=exit' -h 18 -y 20 -x 70 -ta c -sa l -fn $font -fg $fgn -bg $bgn -w $width


